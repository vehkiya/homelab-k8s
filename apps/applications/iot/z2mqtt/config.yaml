# 7-z2m-configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: zigbee2mqtt-config
  namespace: iot
data:
  configuration.yaml: |
    permit_join: false
    
    mqtt:
      base_topic: zigbee2mqtt
      # This points to the k8s service for Mosquitto
      server: 'mqtt://mosquitto-svc.iot.svc.cluster.local'
      # The user/password will be passed via environment variables from a secret
    
    # This points to your Ethernet coordinator
    serial:
      port: tcp://192.168.4.36:6638
      baudrate: 115200
      adapter: ember
      rtscts: false
    
    frontend:
      port: 8080
      enabled: true
      url: 'https://zigbee.kerrlab.app'
    homeassistant:
      enabled: true
      discovery_topic: 'homeassistant'
      status_topic: 'homeassistant/status'
    
    # Advanced settings for running inside Kubernetes
    advanced:
      transmit_power: 20
      log_level: info
      log_output:
        - console