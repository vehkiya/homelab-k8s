apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: ntfy-secret
  namespace: monitoring
spec:
  secretStoreRef:
    name: vaultwarden-fields
    kind: ClusterSecretStore
  target:
    name: ntfy-secret
  data:
    - secretKey: NTFY_WEB_PUSH_PUBLIC_KEY
      remoteRef:
        key: "130c8bc4-cd83-44bb-b701-89c40c0882c7"
        property: "public_key"
    - secretKey: NTFY_WEB_PUSH_PRIVATE_KEY
      remoteRef:
        key: "130c8bc4-cd83-44bb-b701-89c40c0882c7"
        property: "private_key"
    - secretKey: NTFY_WEB_PUSH_EMAIL_ADDRESS
      remoteRef:
        key: "130c8bc4-cd83-44bb-b701-89c40c0882c7"
        property: "email_address"
    ####
    # Generate hash:
    #   docker run --rm -it binwiederhier/ntfy user hash
    # Users separated by commas
    # Format: <username>:<password_hash>:admin
    ####
    - secretKey: NTFY_AUTH_USERS
      remoteRef:
        key: "130c8bc4-cd83-44bb-b701-89c40c0882c7"
        property: "auth_users"
