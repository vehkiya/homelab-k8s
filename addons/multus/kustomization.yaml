resources:
  - https://raw.githubusercontent.com/k8snetworkplumbingwg/multus-cni/refs/tags/v4.2.2/deployments/multus-daemonset-thick.yml

patches:
  - patch: |-
      apiVersion: apps/v1
      kind: DaemonSet
      metadata:
        name: kube-multus-ds # This name is used for matching, but not patched
      spec:
        template:
          spec:
            volumes:
              - name: host-run-netns
                hostPath:
                  path: /var/run/netns
    target:
      kind: DaemonSet
      name: kube-multus-ds
      namespace: kube-system
  - patch: |-
      apiVersion: apps/v1
      kind: DaemonSet
      metadata:
        name: kube-multus-ds
      spec:
        template:
          spec:
            initContainers:
              - name: install-multus-binary
                command:
                  - "/usr/src/multus-cni/bin/install_multus"
                  - "-d"
                  - "/host/opt/cni/bin"
                  - "-t"
                  - "thick"
    target:
      kind: DaemonSet
      name: kube-multus-ds
      namespace: kube-system
  - patch: |-
      apiVersion: apps/v1
      kind: DaemonSet
      metadata:
        name: kube-multus-ds
      spec:
        template:
          spec:
            containers:
              - name: kube-multus
                resources:
                  limits:
                    memory: 2560Mi
    target:
      kind: DaemonSet
      name: kube-multus-ds
      namespace: kube-system 