# kustomize-pv/overlays/uptime-kuma/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

labels:
  - pairs:
      app: uptime-kuma

# Inherit from the base configuration
resources:
  - ../../../base/storage

patches:
  - target:
      kind: PersistentVolume
      name: placeholder-pv # Target the base PV by name
    patch: |-
      # --- Start of PV JSON Patch ---
      - op: replace
        path: /metadata/name
        value: uptime-kuma-config-pv
      - op: replace
        path: /spec/capacity/storage
        value: 5Gi
      - op: replace
        path: /spec/csi/volumeHandle
        value: 885b4724-832c-4e33-8938-a5dffd920305
      # --- End of PV JSON Patch ---

  - target:
      kind: PersistentVolumeClaim
      name: placeholder-pvc # Target the base PVC by name
    patch: |-
      # --- Start of PVC JSON Patch ---
      - op: replace
        path: /metadata/name
        value: uptime-kuma-config-pvc
      - op: replace
        path: /metadata/namespace
        value: notifications
      - op: replace
        path: /spec/resources/requests/storage
        value: 5Gi
      - op: replace
        path: /spec/volumeName
        value: uptime-kuma-config-pv # Match the final patched PV name
      # --- End of PVC JSON Patch ---
      