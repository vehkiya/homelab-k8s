apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: mosquitto-passwordfile-es
spec:
  target:
    name: mosquitto-passwordfile
  
  secretStoreRef:
    name: vaultwarden-fields
    kind: ClusterSecretStore

  data:
    - secretKey: password_key
      remoteRef:
        key: "0dd56e84-a6a6-4be7-9847-94c60732d134"
        property: "MQTT_PASSWORDFILE"
---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: mosquitto-credentials-es
spec:
  target:
    name: mosquitto-credentials
  
  secretStoreRef:
    name: vaultwarden-store
    kind: ClusterSecretStore

  data:
    - secretKey: user
      remoteRef:
        key: "0dd56e84-a6a6-4be7-9847-94c60732d134"
        property: "username"
    - secretKey: password
      remoteRef:
        key: "0dd56e84-a6a6-4be7-9847-94c60732d134"
        property: "password"